Authorities say David  Mora  opened fire inside a Sacramento-area church on Monday, killing his three daughters and another man before taking his own life. Court records chronicle allegations of domestic abuse and warnings from the children’s mother that  Mora — also identified as David Fidel Mora Rojas — was violent. The shooting occurred during a supervised visit with his daughters — who were 9, 10 and 13 years old — at the church. Such visits had been the subject of a legal fight with the girls’ mother. In addition to the children, he killed Nathan Kong, a mutual friend of the family  assigned by the court to supervise Mora’s visits.  Sacramento County court records show that, in May, Illeana Gutierrez Rios filed for a domestic violence restraining order  against Mora, her then-boyfriend. The court granted the order for five years and allowed a mutual friend and member of the church to serve as chaperone for  supervised visits with the couple’s three daughters due to  Mora’s “mental instability,” according to court records. Gutierrez Rios warned the court that Mora was dangerous, and she had fought for a restraining order for the girls as well, but the court ultimately granted him supervised visitations on weekends. “I have moved out of the house with the children because I am afraid of [Mora] and concerned [for] my safety and the safety of my children,” she said in court documents. Gutierrez Rios said in court documents that Mora had been abusive for a decade and had choked her, pushed her, thrown things at her and threatened to kill her. In April, she said, she called the police after an argument during which he had become aggressive and threatened suicide, according to court documents. Police admitted Mora for a weeklong psychiatric hold. Gutierrez Rios and her three daughters then moved out of the Sacramento home they had shared with Mora.  Their daughters had witnessed the argument, Gutierrez Rios told the court. “They were scared and crying,” she said. “My oldest child was biting her nails off.” Mora said that “he has not killed me because he would not know where to go with the children,” Gutierrez Rios said in court documents. Mora fought attempts at a protective order that would keep him from his children, agreeing  to abide by a restraining order from Gutierrez Rios but not from his three daughters. “I do not agree to the protective order for my children,” he wrote in court documents in May. “I want a healthy relationship with my children, separate from Illeana.” According to court records, Mora was allowed only supervised visits with the girls. The visits were to be up to four hours long with a court-approved supervisor, identified as “a mutually agreed upon person from the parents’ church.” Mora was also required to participate in at least 16 anger-management sessions as part of the order. As part of the order, Mora was repeatedly warned in court documents that he could not own or otherwise possess a gun. Law enforcement sources said he used an illegally obtained AR-15-style rifle in the shooting. It is not yet clear how he obtained the weapon. On Tuesday, Sacramento city and county law enforcement officials repeatedly declined to comment. Five days before the killings, the California Highway Patrol had arrested Mora in Merced County on suspicion of driving under the influence, battery on a police officer and resisting arrest in the Los Banos area.  He was subsequently released from the Merced County jail, according to Merced County Sheriff’s Deputy Daryl Allen, a department spokesman. Times staff writer Jessica Garrison contributed to this report from Sacramento.