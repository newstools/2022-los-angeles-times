Stocks gave up early gains and closed broadly lower Friday, capping a turbulent week of trading on Wall Street as uncertainty about the war in Ukraine and surging inflation continue to roil markets. The Standard & Poor’s 500 fell 1.3% after having been up 0.7% in the early going. The benchmark index marked its fourth losing week in the last five, even though it surged in the middle of the week and had its best day since the summer of 2020. The Dow Jones industrial average dropped 0.7% and the Nasdaq composite slid 2.2%. Both also posted weekly losses. European stocks fared better, closing solidly higher. Oil prices ended 3.1% higher after flip-flopping earlier.  The moves are the latest swings for global markets, which have been rocked by dramatic hour-to-hour reversals in prior weeks as investors struggle to guess how high Russia’s invasion of Ukraine will send prices of oil, wheat and other commodities produced in the region. That’s raising the risk the economy may struggle under a toxic combination of persistently high inflation and stagnating growth. The Federal Reserve is expected to raise interest rates at its meeting next week. Despite some positive moves by stocks early Friday, uncertainty about the next developments in the conflict in Ukraine and what the Fed will do probably kept investors in a selling mood heading into the weekend, said Willie Delwiche, investment strategist at All Star Charts. “This remains a headline-driven market,” Delwiche said. “We’re in this environment where you get these exaggerated day-to-day swings, but you don’t make any progress.” Early Friday, before Wall Street opened, the pendulum was swinging toward optimism. European stocks and U.S. stock futures rose abruptly after comments from Russian President Vladimir Putin that some analysts saw as surprisingly optimistic. Putin cited “certain positive developments” in negotiations with Ukraine, though he didn’t offer any details.  The S&P 500 opened with a 0.7% gain, but it quickly flipped to a loss after a reading on sentiment among U.S. consumers sank more than economists expected. Household expectations are rising for high inflation to remain in the near term, causing unease. The S&P ended down 55.21 points at 4,204.31. The Dow fell 229.88 points to 32,944.19, while the Nasdaq fell 286.15 points to 12,843.81 after losing an early gain of 0.8%. The Russell 2000 index of smaller companies fell 32 points, or 1.6%, to 1,979.67. More swings are probably ahead for markets because so much uncertainty remains about the war in Ukraine and inflation. President Biden announced Friday that along with the European Union and the Group of 7 countries, the U.S. will revoke “most favored nation” trade status for Russia. The move opens to door to tariffs on Russian imports. Amid all the uncertainty, U.S. stocks remain about 10% below their peak from earlier this year, while crude oil prices remain more than 40% higher for 2022 so far. A barrel of U.S. crude oil rose 3.1% to settle at $109.33. It briefly topped $130 earlier this week. Prices have sloshed around as worries about disrupted supplies joust with hopes for peace and the possibility that countries outside Russia could boost their production. Brent crude, the international standard, rose 3.1% to settle at $112.67 per barrel. Markets were already on edge before Russia’s invasion, as central banks are set to raise interest rates and remove support for the economy put in place after the pandemic. The Federal Reserve and other central banks hope to stamp out the highest inflation in generations, though they also risk causing a recession if they raise rates too high or too quickly. The wide expectation is for the Federal Reserve to raise its key short-term interest rate by a quarter of a percentage point next week, which would be the first increase since 2018. The yield on the 10-year Treasury has climbed back to around 2%, returning to where it was in February, before worries about the war in Ukraine sent it tumbling below 1.7%. Inflation has surged high enough that politicians around the world know they may be in trouble because of it. Brazil’s state-run oil company Petrobras on Friday increased its prices of fuels sold to its distributors by as much as 25%, citing the war between Russia and Ukraine, as official data showed inflation accelerated in February. The company said in a statement announcing the increase the prior day that for weeks it refrained from passing on costs, but consistently high oil prices forced the adjustment to ensure supply to the Brazilian market. In the U.S., a report on Thursday showed prices at the consumer level leaped 7.9% last month from the prior year, the hottest inflation rate since 1982. It’s likely to get worse in the near term because of oil’s surge after the war and all the financial penalties the U.S. and allies imposed on Russia. Biden has said he wants to limit the economic pain for U.S. households but acknowledged that “defending freedom” incurs costs. — Associated Press writers David Biller, Elaine Kurtenbach and Damian J. Troise contributed to this report.